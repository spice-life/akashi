#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path("../lib", __dir__)

require "yaml"
require "akashi"

unless ARGV.count == 3
  puts <<-EOS
Usage: bundle exec bin/akashi <action> <application> <environment>
       action choose from build, destroy
  EOS
  exit!
end

action, application, environment = ARGV

path_to = {
  aws_config: File.expand_path("../config/aws.yml", __dir__),
  manifests:  File.expand_path("../config/manifests.yml", __dir__),
}

Akashi::AWS.config = YAML.load_file(path_to[:aws_config])

Akashi.manifests   = YAML.load_file(path_to[:manifests])
Akashi.application = application
Akashi.environment = environment

Akashi.send(action.intern)
